<html>
  <head>
    <title>{{name}}</title>
    <style type="text/css">
      html,
      body,
      #h5p-container,
      #h5p-container > .h5p-iframe-wrapper,
      #h5p-container > .h5p-iframe-wrapper > iframe {
        margin: 0px;
        padding: 0px;
        height: 100vh !important; /* no seriously, it is important to avoid a rediculous resize bug in h5p */
        width: 100vw !important;
        overflow: hidden;
        background-color: white;
      }
    </style>
    <meta charset="utf-8" />
    <script type="text/javascript" src="main.bundle.js"></script>
    <script type="text/javascript">
    var init = (function(){
          var qs = window.location.search.split("?")[1] ? window.location.search.split("?")[1].split(",") : [0,0];
          return {
            data: qs[0],
            index: qs[1] ? +qs[1] : -1
          }
        })(),
        calculated = false;

    H5P.externalDispatcher.on('xAPI', function (event) {
      var score = calculated ? 1 : 0;
      if (event.data.statement.hasOwnProperty('verb')) {
        if (event.data.statement.verb.id === 'http://adlnet.gov/expapi/verbs/completed') {
          score = 1;
          calculated = true;
        }
      }

      parent.dispatchEvent(new CustomEvent(
        "statuschange",
          {
          detail: {
            userdata: event.data.statement,
            score: score, // score has to match required in order for a completion
            required: 1,
            index: init.index
          }
        }
      ));

      // // event.getScore() // not the greatest property name
        // var passed = result.score.scaled >= scoreRequired,
        //   verb = result.getVerb();


    });
    </script>
  </head>
  <body>
    <div id="h5p-container"></div>
    <script type="text/javascript">
      var element = document.getElementById("h5p-container");
      const h5p = new H5PStandalone.H5P(element, '{{workspace}}');
    </script>
  </body>
</html>